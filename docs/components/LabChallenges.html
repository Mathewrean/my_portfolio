<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab Challenges</title>
    <link rel="stylesheet" href="../styles/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation placeholder -->
    <div id="sidebar-placeholder"></div>
    <script>
      fetch('sidebar-nav.html')
        .then(response => {
          if (!response.ok) throw new Error('Failed to load sidebar');
          return response.text();
        })
        .then(data => {
          document.getElementById('sidebar-placeholder').innerHTML = data;
          if (typeof initializeSidebar === 'function') {
            initializeSidebar();
          }
        })
        .catch(error => console.error('Error loading sidebar:', error));
    </script>

    <div class="lab-challenges-container container">
        <h1>Lab Challenges</h1>

        <section class="challenge-options">
          <h2>Explore Challenges</h2>
          <div class="options">
            <a href="CTFChallenges.html" class="option-button">CTF Challenges</a>
            <a href="TryHackMeRooms.html" class="option-button">TryHackMe Rooms</a>
            <a href="HackTheBoxRooms.html" class="option-button">Hack The Box Rooms</a>
          </div>
        </section>

        <div class="challenge">
            <h2>Challenge 1: [Problem Statement]</h2>
            <p><strong>Approach:</strong> [Describe your approach to solving the challenge]</p>
            <p><strong>Tools Used:</strong> [List the tools and technologies used]</p>
            <img src="../assets/challenge1-screenshot.jpg" alt="Challenge 1 Screenshot">
            <p><strong>Key Lessons Learned:</strong> [Discuss what you learned from this challenge]</p>
            <button class="like-button" onclick="incrementLike(this)">üëç Like <span class="like-count">0</span></button>
            <button class="dislike-button" onclick="incrementDislike(this)">üëé Dislike <span class="dislike-count">0</span></button>
        </div>

        <div class="challenge">
            <h2>Challenge 2: [Problem Statement]</h2>
            <p><strong>Approach:</strong> [Describe your approach to solving the challenge]</p>
            <p><strong>Tools Used:</strong> [List the tools and technologies used]</p>
            <img src="../assets/challenge2-screenshot.jpg" alt="Challenge 2 Screenshot">
            <p><strong>Key Lessons Learned:</strong> [Discuss what you learned from this challenge]</p>
            <button class="like-button" onclick="incrementLike(this)">üëç Like <span class="like-count">0</span></button>
            <button class="dislike-button" onclick="incrementDislike(this)">üëé Dislike <span class="dislike-count">0</span></button>
        </div>

        <div class="challenge">
            <h2>Challenge 3: [Problem Statement]</h2>
            <p><strong>Approach:</strong> [Describe your approach to solving the challenge]</p>
            <p><strong>Tools Used:</strong> [List the tools and technologies used]</p>
            <img src="../assets/challenge3-screenshot.jpg" alt="Challenge 3 Screenshot">
            <p><strong>Key Lessons Learned:</strong> [Discuss what you learned from this challenge]</p>
            <button class="like-button" onclick="incrementLike(this)">üëç Like <span class="like-count">0</span></button>
            <button class="dislike-button" onclick="incrementDislike(this)">üëé Dislike <span class="dislike-count">0</span></button>
        </div>
    </div>

    <script>
      function incrementLike(button) {
        const challengeDiv = button.closest('.challenge');
        const likeKey = challengeDiv.querySelector('h2').textContent + '-like';
        const dislikeKey = challengeDiv.querySelector('h2').textContent + '-dislike';
        const likedKey = challengeDiv.querySelector('h2').textContent + '-liked';
        const dislikedKey = challengeDiv.querySelector('h2').textContent + '-disliked';

        // Prevent multiple clicks
        if (localStorage.getItem(likedKey) === 'true') {
          alert('You have already liked this challenge.');
          return;
        }
        if (localStorage.getItem(dislikedKey) === 'true') {
          alert('You have already disliked this challenge.');
          return;
        }

        const countSpan = button.querySelector('.like-count');
        let count = parseInt(countSpan.textContent);
        count++;
        countSpan.textContent = count;

        // Store count and user action in localStorage to persist
        localStorage.setItem(likeKey, count);
        localStorage.setItem(likedKey, 'true');
      }

      function incrementDislike(button) {
        const challengeDiv = button.closest('.challenge');
        const likeKey = challengeDiv.querySelector('h2').textContent + '-like';
        const dislikeKey = challengeDiv.querySelector('h2').textContent + '-dislike';
        const likedKey = challengeDiv.querySelector('h2').textContent + '-liked';
        const dislikedKey = challengeDiv.querySelector('h2').textContent + '-disliked';

        // Prevent multiple clicks
        if (localStorage.getItem(dislikedKey) === 'true') {
          alert('You have already disliked this challenge.');
          return;
        }
        if (localStorage.getItem(likedKey) === 'true') {
          alert('You have already liked this challenge.');
          return;
        }

        const countSpan = button.querySelector('.dislike-count');
        let count = parseInt(countSpan.textContent);
        count++;
        countSpan.textContent = count;

        // Store count and user action in localStorage to persist
        localStorage.setItem(dislikeKey, count);
        localStorage.setItem(dislikedKey, 'true');
      }

      // On page load, restore counts from localStorage
      window.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('.challenge').forEach(challenge => {
          const title = challenge.querySelector('h2').textContent;
          const likeKey = title + '-like';
          const dislikeKey = title + '-dislike';
          const likeCount = localStorage.getItem(likeKey);
          const dislikeCount = localStorage.getItem(dislikeKey);
          if (likeCount !== null) {
            const likeSpan = challenge.querySelector('.like-count');
            likeSpan.textContent = likeCount;
          }
          if (dislikeCount !== null) {
            const dislikeSpan = challenge.querySelector('.dislike-count');
            dislikeSpan.textContent = dislikeCount;
          }
        });
      });
    </script>
</body>
</html>
